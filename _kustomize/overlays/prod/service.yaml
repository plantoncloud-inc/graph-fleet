apiVersion: kubernetes.project-planton.org/v1
kind: KubernetesDeployment
metadata:
  name: graph-fleet
  env: app-prod
  labels:
    pulumi.project-planton.org/stack.name: app-prod.KubernetesDeployment.graph-fleet
    kubernetes.project-planton.org/namespace: service-app-prod-graph-fleet
spec:
  availability:
    minReplicas: 1  # Production redundancy
    horizontalPodAutoscaling:
      isEnabled: false
  container:
    app:
      env:
        variables:
          ENV: production
          LANGCHAIN_ENDPOINT: $variables-group/langchain/api-endpoint
          LANGSMITH_PROJECT: graph-fleet-prod
        secrets:
          # Production-specific secrets (different from local/dev)
          TAVILY_API_KEY: $secrets-group/tavily/prod.api-key
          LANGSMITH_API_KEY: $secrets-group/langchain/prod.api-key
          GITHUB_TOKEN: $secrets-group/github/token
          ANTHROPIC_API_KEY: $secrets-group/anthropic/prod.api-key
          OPENAI_API_KEY: $secrets-group/openai/prod.api-key
      resources:
        limits:
          cpu: 2000m
          memory: 2Gi
        requests:
          cpu: 200m
          memory: 512Mi

